# Operating etcd clusters 运行etcd集群
## System configuration 系统配置
### Hardware recommendations 硬件建议
#### Page Contents
etcd通常运行良好，有限的资源用于开发或测试目的; 在笔记本电脑或便宜的云计算机上与etcd一起开发是很常见的。但是，在生产中运行etcd群集时，某些硬件准则对于正确管理很有用。这些建议不是硬性规定; 他们作为强大的生产部署的良好起点。与往常一样，部署应在运行生产之前使用模拟工作负载进行测试。

#### CPUs
很少的etcd部署需要大量的CPU容量。典型的集群需要两到四个内核来平稳运行。负载较重的etcd部署，每秒服务数千个客户端或成千上万个请求，往往受CPU限制，因为etcd可以服务来自内存的请求。如此繁重的部署通常需要8至16个专用内核。

#### Memory
etcd具有相对较小的内存占用量，但其性能仍取决于是否具有足够的内存。一个etcd服务器将主动缓存键值数据，并花费大部分其他内存跟踪观察者。通常8GB就够了。对于拥有数千个观察者和数百万个密钥的大量部署，相应地分配16GB到64GB的内存。

#### Disks
快速磁盘是etcd部署性能和稳定性的最关键因素。

慢速磁盘会增加etcd请求延迟并可能伤害群集稳定性。由于etcd的一致性协议依赖于将元数据持久存储到日志中，因此大多数etcd集群成员必须将每个请求写入磁盘。此外，etcd也将增量检查其状态到磁盘，以便截断此日志。如果这些写入时间过长，心跳可能会超时并触发选举，从而破坏群集的稳定性。

etcd对磁盘写入延迟非常敏感。通常需要50个顺序IOPS（例如7200 RPM磁盘）。对于负载较重的集群，建议使用500个连续的IOPS（例如，典型的本地SSD或高性能虚拟块设备）。请注意，大多数云提供商发布并发IOPS而不是顺序IOPS; 已发布的并发IOPS可能比顺序IOPS高出10倍。要衡量实际的顺序IOPS，我们建议使用磁盘基准测试工具，如diskbench或fio。

etcd只需要适度的磁盘带宽，但当失败的成员必须赶上集群时，更多的磁盘带宽会缩短恢复时间。通常10MB /秒将在15秒内恢复100MB数据。对于大型群集，建议100MB / s或更高的速度在15秒内恢复1GB数据。

如有可能，请使用SSD备份etcd的存储。SSD通常比旋转磁盘具有更低的写延迟和更小的变化，从而提高了etcd的稳定性和可靠性。如果使用旋转磁盘，可以获得最快的磁盘（15,000 RPM）。对于旋转磁盘和SSD，使用RAID 0也是提高磁盘速度的有效方法。至少有三个集群成员，RAID的镜像和/或奇偶校验变体是不必要的; etcd的一致性复制已经获得高可用性。

#### Network
多成员etcd部署受益于快速可靠的网络。为了让etcd兼容且分区容错，具有分区中断的不可靠网络将导致可用性不佳。低延迟确保etcd成员可以快速通信。高带宽可以减少恢复失败的etcd成员的时间。1GbE足够用于常见的etcd部署。对于大型etcd集群，10GbE网络将缩短平均恢复时间。

尽可能在单个数据中心内部署etcd成员，以避免延迟开销并降低分区事件的可能性。如果需要另一个数据中心的故障域，请选择更接近现有数据中心的数据中心。另请阅读调优文档以获取有关跨数据中心部署的更多信息。
#### Example hardware configurations 示例硬件配置
##### Small cluster
略
##### Medium cluster
略
##### Large cluster
略
##### xLarge cluster
略
